<!DOCTYPE html>
<html>
<head>
    <title>Welcome to this digital mirror</title>
    <link href='css/bootstrap.css' rel='stylesheet'>
    <link href="css/clock.css" rel="stylesheet">

    <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="js/css_clocks_1.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
<div class="container-fluid">

    <div class="col-md-3" id="cssclock">
        <div id="clockanalog">
            <img src="images/analogseconds.png" id="analogsecond"
                 alt="Clock second-hand"/>
            <img src="images/analogminutes.png"
                 id="analogminute" alt="Clock minute-hand"/>
            <img src="images/analoghours.png" id="analoghour"
                 alt="Clock hour-hand"/>
        </div>
    </div>
    <div class="col-md-6">
        <div class="col-md-12">
            <h2>Nästa avgång: 7min</h2>
        </div>
        <div class="col-md-12" id="notification_message">

        </div>
    </div>
    <div class="col-md-3" id="WOD">
    </div>
</div>

<script type="text/javascript">
    var bScriptLoaded = false;
    var bDOMLoaded = false;
    var bClocksInitialised = false;

    function ClockInit() {
        if ((bClocksInitialised != true) && (bDOMLoaded == true) && (bScriptLoaded == true)) {
            bClocksInitialised = true;
            oClockAnalog.fInit();
            oClockDigital.fInit();
        }
    }
</script>
<script type="text/javascript">
    console.log("Sending shit");
    var socket = io.connect('http://localhost:8080');
    socket.on('messageCenter', function (data) {
        console.log("DATA Recieved: " + data);
        var notification = "";
        for (var obj in data) {
            var message = data[obj];
            notification += message.message + "<br>";
        }
        $('#notification_message').html(notification);
    });
    socket.on('todaysWOD', function(data) {
        data = JSON.parse(JSON.stringify(data).replace(/\\r\\n/g, "<br/>"));
        console.log("Recieved todays WOD: " + data);
        var WOD = "";
        for (var obj in data) {
            var component = data[obj];
            name = component["name"];
            nbrOfReps = component["nbrOfReps"];
            typeOfScheme = component["typeOfScheme"];
            comment = component["comment"];
            description = component["description"];

            if(nbrOfReps) WOD += "<h3>" + name + " (" + nbrOfReps + ") </h3>";
            else if(typeOfScheme) WOD += "<h3>" + name + " (" + typeOfScheme + ") </h3>";
            else if(name) WOD += "<h3>" + name + "</h3>";
            if(comment) WOD += comment;
            if(description) WOD += description;
            console.log(WOD);
        }
        $('#WOD').html(WOD);
    });
</script>
</body>
</html>